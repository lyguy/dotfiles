#!/bin/bash

# add .local/bin to path
if [ -d "$HOME/.local/bin" ]; then
    export PATH=$HOME/.local/bin:$PATH
fi

# Set up OPAM
if [ -f "$HOME/.opam/opam-init/init.sh" ]; then
    #shellcheck source=/dev/null
    source "$HOME/.opam/opam-init/init.sh" > /dev/null 2> /dev/null || true
    eval "$(opam config env)"
fi

# Rust cargo bins
if [ -d "$HOME/.cargo/bin/" ]; then
    export PATH=$HOME/.cargo/bin:$PATH
    RUST_SRC_PATH="$(rustc --print sysroot)/lib/rustlib/src/rust/src"
    export RUST_SRC_PATH
fi

# Go
if [ -d "${HOME}/go" ]; then
    export GOPATH="${HOME}/go"
    export PATH="/usr/local/go/bin:${GOPATH}/bin:${PATH}"
fi


# Google Cloud
# The next line updates PATH for the Google Cloud SDK.
file="${HOME}/google-cloud-sdk/path.bash.inc"
if [ -f "${file}" ]; then
    #shellcheck source=/dev/null
    source "${file}"
fi

# The next line enables shell command completion for gcloud.
file="${HOME}/google-cloud-sdk/completion.bash.inc"
if [ -f "${file}" ]; then
    #shellcheck source=/dev/null
    source "${file}"
fi

# RVM
file="${HOME}/.rvm/scripts/rvm"
if [[ -f "${file}" ]] && [[ -r "${file}" ]]; then
    #shellcheck source=/dev/null
    source "${file}"
fi

# PHP :(
dir="${HOME}/.composer/vendor/bin"
if [ -d "${dir}" ]; then
    export PATH="${dir}:${PATH}"
fi

# PG 11
dir="/usr/local/opt/postgresql@11/bin"
if [ -d "${dir}" ]; then
    export PATH="${dir}:$PATH"
fi
    
#NVM
dir="/usr/local/opt/nvm"
if [ -d "${dir}" ]; then
    export NVM_DIR="$HOME/.nvm"
    #shellcheck source=/dev/null
    [ -s "${dir}/nvm.sh" ] && source "${dir}/nvm.sh"  # This loads nvm
    #shellcheck source=/dev/null
    [ -s "${dir}/etc/bash_completion.d/nvm" ] && source "${dir}/etc/bash_completion.d/nvm"  # This loads nvm bash_completion
fi

# Conda
conda_home="${HOME}/anaconda3"
if [ -d "${conda_home}" ]; then
    if __conda_setup=$("${conda_home}/bin/conda" 'shell.bash' 'hook' 2> /dev/null); then
        eval "$__conda_setup"
    else
        if [ -f "${conda_home}/etc/profile.d/conda.sh" ]; then
            #shellcheck source=/dev/null
            source "${conda_home}/etc/profile.d/conda.sh"
        else
            export PATH="${conda_home}/bin:$PATH"
        fi
    fi
    if [[ -n $TMUX ]]; then
        conda deactivate; conda activate base
    fi
unset __conda_setup
fi
